🧠 Avvio training CalciumVQVAE con W&B logging...
Using device: cuda
📊 Caricamento dataset Allen Brain...
🧠 Loading Allen Brain Observatory data for reconstruction...
Using session: 501474098
🔍 Extracting data directly from HDF5 for session 501474098...
   📁 NWB file path: C:\Users\Claudio\Desktop\Tesi VQVAE 1\brain_observatory\ophys_experiment_data\501474098.nwb
   ✅ Found running speed data in HDF5
   📊 Speed data shape: (105578,)
   📈 Speed range: -19.410 - 34.635
   ✅ Valid speed data: 99.9% (105434/105578)
   ✅ Found neural data in HDF5
   🔄 Transposed DFF data for correct alignment
   📊 DFF data shape: (105743, 108)
   🔧 Preprocessing neural data...
  ✅ Successfully extracted neural data from HDF5!
  🔄 Transposed DFF traces to (neurons, time)
  📊 Final neural data shape: (108, 105743)
  📊 Neuron selection stats:
     Mean correlation: 0.073
     Mean variance: 0.163
  ✅ Selected 30 active neurons
📊 Final dataset: 10570 windows
   Neural data shape: torch.Size([10570, 30, 50])
Dataset caricato: 10570 campioni
Split: 7398 train, 3172 test
🏗️  Creazione modello...
Modello creato con 212,158 parametri
🚀 Inizio training...
Epoch   0: Train Loss=1.0463 | Test MSE=0.9355, MAE=0.3991, Corr=0.2455
